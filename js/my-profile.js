let usuario = JSON.parse(localStorage.getItem("usuario"));
let nombreCompleto;
let nuevoAvatar;
let correo;
let telefono;
let edad;
let nacimiento;


let datos;



//Función que se ejecuta una vez que se haya lanzado el evento de
//que el documento se encuentra cargado, es decir, se encuentran todos los
//elementos HTML presentes.
document.addEventListener("DOMContentLoaded", function (e) {

    document.getElementById("vista-previa").src = usuario.avatar;
    document.getElementById("vista-previa-zoom").src = usuario.avatar;
    document.getElementById("foto-perfil").src = usuario.avatar;    
    document.getElementById("nombre-perfil").innerText = usuario.nombre;
    document.getElementById("nombre-usuario").value = usuario.nombre;
    mostrarInfo();
    

    
    
    // Mostrar ventana de actualizar datos
    document.getElementById("actualizar").addEventListener("click", () => {
        document.getElementById("ventana-actualizar").style.display = "block"
    })
    // Cerrar ventana de actualizar datos
    document.getElementById("cerrar-actualizar").addEventListener("click", () => {
        document.getElementById("ventana-actualizar").style.display = "none"
    })
    
    // Mostrar ventana de actualizar datos
    document.getElementById("info-cuenta").addEventListener("click", () => {
        mostrarInfo();
        document.getElementById("ventana-info").style.display = "block"
    })
    // Cerrar ventana de info personal 
    document.getElementById("cerrar-info").addEventListener("click", () => {
        document.getElementById("ventana-info").style.display = "none"
    })
    
    // probando weas
    let elementoImagen = document.getElementById("imagen")
    elementoImagen.addEventListener("change", () => {

        let archivo = elementoImagen.files[0];
        console.log(archivo)


        let reader = new FileReader();
        reader.readAsDataURL(archivo);
        reader.onloadend = function() {
            nuevoAvatar = reader.result;
            document.getElementById("vista-previa").src = nuevoAvatar;
            document.getElementById("vista-previa-zoom").src = nuevoAvatar;  
        }



    });
    

    console.log(usuario);

});




function guardarCambios(){

    usuario.avatar = nuevoAvatar;
    
    nombreCompleto = String(document.getElementById("nombres").value+" "+document.getElementById("apellidos").value);
    usuario.nombreCompleto = nombreCompleto; 
    console.log(usuario.nombreCompleto);
    usuario.nombre = String(document.getElementById("nombre-usuario").value);
    console.log(usuario.nombre);
    usuario.correo = String(document.getElementById("correo").value);
    console.log(usuario.correo);
    usuario.pais = String(document.getElementById("pais").value);
    console.log(usuario.pais);
    usuario.telefono = parseFloat(document.getElementById("telefono").value);
    console.log(usuario.telefono);
    usuario.edad = parseFloat(document.getElementById("edad").value);
    console.log(usuario.edad);

    localStorage.setItem('usuario',JSON.stringify(usuario));
    sessionStorage.setItem('usuario',JSON.stringify(usuario));
    alert("Done")
    location.reload();
}

function mostrarInfo(){
    let usuario = JSON.parse(localStorage.getItem("usuario"));
    datos =`
        <div class="column text-right">
            <div class="table list">
                <div class="content">
                    <span class="subtitle text-muted"> Nombre completo</span>
                </div>
                <div class="content">
                    <span class="subtitle text-muted"> Usuario </span>
                </div>
                <div class="content">
                    <span class="subtitle text-muted subtitle"> Correo electrónico </span>
                </div>
                <div class="content">
                    <span class="subtitle text-muted"> Teléfono </span>
                </div>
                <div class="content">
                    <span class="subtitle text-muted"> Pais </span>
                </div>
                <div class="content">
                    <span class="subtitle text-muted"> Edad </span>
                </div>  
            </div>
        </div>
        <div class="column text-left">
            <div class="table list">
                <div class="content">
                    <span class="subtitle">${usuario.nombreCompleto}</span>
                </div>
                <div class="content">
                    <span class="subtitle">${usuario.nombre}</span>
                </div>
                <div class="content">
                    <span class="subtitle">${usuario.correo}</span>
                </div>
                <div class="content">
                    <span class="subtitle">${usuario.telefono}</span>
                </div>
                <div class="content">
                    <span class="subtitle">${usuario.pais}</span>
                </div>
                <div class="content">
                    <span class="subtitle">${usuario.edad} años.</span>
                </div>  
            </div>
        </div>


        






    `;

    document.getElementById("mostrar-info").innerHTML = datos;
}




